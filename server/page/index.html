<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <!-- Последняя компиляция и сжатый CSS -->
    <link rel="stylesheet" href="bootstrap-theme.min.css">

    <!-- Дополнение к теме -->
    <link rel="stylesheet" href="bootstrap.min.css">
</head>
<body>
<h1>sdfjs</h1>

<h3>File Upload:</h3>
Select a file to upload: <br />

<form action = "http://localhost:3000/file_upload" method = "POST" id="uploadForm" enctype = "multipart/form-data">
    <input type="file" name="file" size="50" />
    <br />
    <select id="typeSheet" name="sheet">
        <option value="0">АНОНС</option>
        <option value="1">ВЕЛОСИПЕДЫ</option>
        <option value="2">СПОРТ_ТУРИЗМ</option>
        <option value="3">ЗАПЧАСТИ</option>
        <option value="4">ИГРУШКА</option>
        <option value="5">ИТОГ</option>
        <option value="6">ОБЩИЙ_ЗАКАЗ</option>
        <option value="7">наличие на складе</option>
    </select>
    <br/>
    <input type = "button" id="get" value = "Upload File" />
</form>
<span id = "status">asd</span>

<button id="test">defsds</button>
<img id="img"/>
<!--<div class="container">
    <div class="row">
        <div class="table-responsive">
            <table class="table table-hover">
                <thead>
                <tr>
                    <th>#</th>
                    <th>Table heading</th>
                    <th>Table heading</th>
                    <th>Table heading</th>
                    <th>Table heading</th>
                    <th>Table heading</th>
                    <th>Table heading</th>
                </tr>
                </thead>
                <tbody id="myTable">
                <tr>
                    <td>1</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                </tr>
                <tr>
                    <td>2</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                </tr>
                <tr>
                    <td>3</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                </tr>
                <tr>
                    <td>4</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                </tr>
                <tr class="success">
                    <td>5</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                </tr>
                <tr>
                    <td>6</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                </tr>
                <tr>
                    <td>7</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                </tr>
                <tr>
                    <td>8</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                </tr>
                <tr>
                    <td>9</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                </tr>
                <tr>
                    <td>10</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                    <td>Table cell</td>
                </tr>
                </tbody>
            </table>
        </div>
        <div class="col-md-12 text-center">
            <ul class="pagination pagination-lg pager" id="myPager"></ul>
        </div>
    </div>
</div>-->
<div class="container">
    <h4>Сколько показывать</h4>
    <div class="form-group">
        <select name="state" id="maxRows" class="form-control" style="width: 150px">
            <option selected value="5">5</option>
            <option value="10">10</option>
            <option value="50">50</option>
            <option value="100">100</option>
            <option value="500" id="all">Show All</option>
        </select>
    </div>
    <table id="myTable" class="table table-bordered table-striped">
        <thead>
            <tr>
                <th>Картинка</th>
                <th>Производитель</th>
                <th>Наименование</th>
                <th>Цена с НДС</th>
                <th>Артикул</th>
                <th>Характеристики</th>
            </tr>
        </thead>
        <tbody id="data">
        </tbody>
    </table>

<div class="pagination-container">
    <nav>
        <ul class="pagination"></ul>
    </nav>
</div>
</div>

<!-- Последняя компиляция и сжатый JavaScript -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

<script>

    $(document).ready(function() {
        $('#get').click(function () {
            alert('z nen');
            // var sheet = document.getElementById("typeSheet");
            // console.log(sheet);
            var fd = new FormData(document.getElementById("uploadForm"));
            // fd.append('sheet', sheet);
            console.log(fd.get('sheet'));
            $.ajax({
                url: '/file_upload',
                data: fd,
                method: 'POST',
                processData: false,
                contentType: false,
                success: function (data) {
                    // $('#all').value = data.length;
                    // var table = document.createElement('table');
                    var counter = 0;

                    var table = document.getElementById('data');
                    alert(Object.keys(data[0]).length);
                    for (var i = 0; i < 1000; i++) {
                        if (Object.keys(data[0]).length > 10) {
                            var tr = document.createElement('tr');
                            var tdImage = document.createElement('td');
                            var tdMark = document.createElement('td');
                            var tdType = document.createElement('td');
                            var tdCost = document.createElement('td');
                            var tdArticul = document.createElement('td');
                            var tdAbout = document.createElement('td');

                            var image = document.createElement('img');
                            image.className = 'img-thumbnail';
                            image.style = 'width:18rem';
                            image.src = 'https://drive.google.com/uc?export=download&confirm=no_antivirus&id=' + data[i]['ССЫЛКА'];

                            var divImage = document.createElement('div');
                            divImage.appendChild(image);
                            // var text1 = document.createTextNode(data[0]['БЕЗНАЛ']);
                            var textMark = document.createTextNode(data[i]['ТОРГОВАЯ МАРКА']);
                            var textType = document.createTextNode(data[i]['НАИМЕНОВАНИЕ']);
                            var textCost = document.createTextNode(data[i]['ЦЕНА С НДС - предоплата, BYN']);
                            var textAbout = document.createTextNode(data[i]['ХАРАКТЕРИСТИКИ']);
                            var textArtikul = document.createTextNode(data[i]['АРТИКУЛ']);

                            tdImage.appendChild(divImage);
                            tdMark.appendChild(textMark);
                            tdType.appendChild(textType);
                            tdCost.appendChild(textCost);
                            tdArticul.appendChild(textArtikul);
                            tdAbout.appendChild(textAbout);
                            tr.appendChild(tdImage);
                            tr.appendChild(tdMark);
                            tr.appendChild(tdType);
                            tr.appendChild(tdCost);
                            tr.appendChild(tdArticul);
                            tr.appendChild(tdAbout);

                            table.appendChild(tr);
                        } else {
                            counter++;
                        }
                    }
                    // document.body.appendChild(table);
                    // for (var i = 0; i < data.length; i++){
                    //
                    // }
                    // document.body.appendChild(table);
                    alert(counter + ' = не праильных');

                    $(function () {
                        $('table tr:eq(0)').prepend('<th>ID</th>');
                        var id = 0;
                        $('table tr:gt(0)').each(function () {
                            id++;
                            $(this).prepend('<td>' + id + '</td>');
                        });
                    });

                    $('#myTable').show();
                    // document.getElementById("img").src = 'https://drive.google.com/uc?export=download&confirm=no_antivirus&id='+ data[0]['ССЫЛКА'];
                    // alert(t);
                }
            });
        });
    });



    /////////////////пагинация

    /*$.fn.pageMe = function(opts){
        var $this = this,
            defaults = {
                perPage: 7,
                showPrevNext: false,
                hidePageNumbers: false
            },
            settings = $.extend(defaults, opts);

        var listElement = $this;
        var perPage = settings.perPage;
        var children = listElement.children();
        var pager = $('.pager');

        if (typeof settings.childSelector!="undefined") {
            children = listElement.find(settings.childSelector);
        }

        if (typeof settings.pagerSelector!="undefined") {
            pager = $(settings.pagerSelector);
        }

        var numItems = children.size();
        var numPages = Math.ceil(numItems/perPage);

        pager.data("curr",0);

        if (settings.showPrevNext){
            $('<li><a href="#" class="prev_link">«</a></li>').appendTo(pager);
        }

        var curr = 0;
        while(numPages > curr && (settings.hidePageNumbers==false)){
            $('<li><a href="#" class="page_link">'+(curr+1)+'</a></li>').appendTo(pager);
            curr++;
        }

        if (settings.showPrevNext){
            $('<li><a href="#" class="next_link">»</a></li>').appendTo(pager);
        }

        pager.find('.page_link:first').addClass('active');
        pager.find('.prev_link').hide();
        if (numPages<=1) {
            pager.find('.next_link').hide();
        }
        pager.children().eq(1).addClass("active");

        children.hide();
        children.slice(0, perPage).show();

        pager.find('li .page_link').click(function(){
            var clickedPage = $(this).html().valueOf()-1;
            goTo(clickedPage,perPage);
            return false;
        });
        pager.find('li .prev_link').click(function(){
            previous();
            return false;
        });
        pager.find('li .next_link').click(function(){
            next();
            return false;
        });

        function previous(){
            var goToPage = parseInt(pager.data("curr")) - 1;
            goTo(goToPage);
        }

        function next(){
            goToPage = parseInt(pager.data("curr")) + 1;
            goTo(goToPage);
        }

        function goTo(page){
            var startAt = page * perPage,
                endOn = startAt + perPage;

            children.css('display','none').slice(startAt, endOn).show();

            if (page>=1) {
                pager.find('.prev_link').show();
            }
            else {
                pager.find('.prev_link').hide();
            }

            if (page<(numPages-1)) {
                pager.find('.next_link').show();
            }
            else {
                pager.find('.next_link').hide();
            }

            pager.data("curr",page);
            pager.children().removeClass("active");
            pager.children().eq(page+1).addClass("active");

        }
    };*/


    ////////////////

var table = '#myTable';
$('#maxRows').on('change', function () {
    $('.pagination').html('');
    var trNum = 0;
    var maxRows = parseInt($(this).val());
    var totalRows = $(table + ' tbody tr').length;
    $(table + ' tr:gt(0)').each(function () {
        trNum++;
        if (trNum > maxRows){
            $(this).hide();
        }
        if (trNum <= maxRows){
            $(this).show();
        }
    });
    if (totalRows > maxRows){
        var pagenum = Math.ceil(totalRows/maxRows);
        for (var i = 1; i <= pagenum;){
            $('.pagination').append('<li data-page="' + i + '">\<span>' + i++ + '<span class="sr-only">(current)</span></span>\</li>').show();
        }
    }
    $('.pagination li:first-child').addClass('active');
    $('.pagination li').on('click', function () {
        var pageNum = $(this).attr('data-page');
        var trIndex = 0;
        $('.pagination li').removeClass('active');
        $(this).addClass('active');
        $(table + ' tr:gt(0)').each(function () {
            trIndex++;
            if (trIndex > (maxRows * pageNum) || trIndex <= ((maxRows * pageNum) - maxRows)) {
                $(this).hide();
            } else {
                $(this).show();
            }
        });
    });
});
$('#myTable').hide();
    // Инициализация при загрузке страницы
</script>
</body>
</html>